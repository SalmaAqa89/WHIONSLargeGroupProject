{% extends 'base_content2.html' %}
{% block content %}
<div class="container">

  <div class="row">
    <div class="col-12">
      <h1>Welcome to your Journal Log</h1>
      <a href="{% url 'create_entry' %}" class="btn btn-primary">New Journal Entry</a>
     <!-- Search Form -->    
      
      <form method="get" action="{% url 'search_journal' %}" id="search-form" class="form-inline">
          {% csrf_token %}
          <input type="text" name="title" placeholder="Search Journals..." class="form-control" id="journal-search-box" oninput="showJournalSuggestions(this.value)">
          <button type="submit" class="btn btn-primary">Search</button>
      </form>
      <style>
        #search-form .form-control {
           width: auto; 
        }
        #search-form .btn {
           width:auto;  
        }
        #journal-suggestions-container {
          position: absolute; /* 推荐列表绝对定位，基于它的父元素定位 */
          width: auto; /* 推荐列表宽度与输入框宽度相同 */
          background:  lightblue; /* 背景色设为白色 */
          box-shadow: 0 4px 8px rgba(0,0,0,0.1); /* 添加阴影效果 */
          border-radius: 0 0 5px 5px; /* 只为下方的边角设置圆角 */
          overflow: hidden; /* 隐藏溢出的内容 */
          z-index: 1000; /* 确保推荐列表显示在页面上的其他元素之上 */
        }
        #journal-suggestions-container > div {
          padding: 10px; 
          border-bottom: 1px solid #eee; 
          cursor: pointer; 
        }
        
        #journal-suggestions-container > div:hover {
          background-color: #f9f9f9; /* 鼠标悬停时推荐项的背景色 */
        }
        </style>
   
     <div id="journal-suggestions-container" class="suggestions-container"></div>
     <a href="{% url 'journal_log' %}" class="btn btn-secondary">View All Entries</a>
     <div class="card-deck">
    {% for entry in journal_entries %}
      {% if not entry.deleted %}
        <div class="card mb-3">
          <div class="card-body">
            <h5 class="card-title">{{ entry.title }}</h5>
            <h6 class="card-subtitle mb-2 text-muted">{{ entry.created_at }}</h6>
            <p class="card-text" id="preview-{{ entry.id }}">{{ entry.text|truncatewords:50 }}</p>
            <p class="card-text d-none" id="full-text-{{ entry.id }}">{{ entry.text|safe}}</p>
       <button class="btn btn-primary see-more" onclick="openJournalEntryInNewWindow('{{ entry.id }}')">See More</button>


            <p>Mood: {{ entry.get_mood_display }}</p>
            <a href="{% url 'delete_entry' entry_id=entry.id %}" class="btn btn-danger">Delete Entry</a>
          </div>
        </div>
      {% endif %}
    {% empty %}
      <p>No journal entries found.</p>
    {% endfor %}
  </div>
</div>

{% endblock %}


